.rule_4_1_6_ensure_rpki_is_set_for_origin_validation_of_ebgp_peers

Reference: Infrastructure](https://www.juniper.net/documentation/en_US/release-
independent/nce/information-products/pathway-pages/nce/nce-187-bgp-rpki-
tn.html),available for free from the Juniper website.
Validator](https://labs.ripe.net/Members/tashi_phuntsho_3/how-to-install-an-
rpki-validator)







Remediation: Configuration and deployment of an RPKI Validator and a full discussion of all
configuration options is beyond the scope of this Benchmark.
To configure an RPKI Validator Server, issue following commands from the [edit
routing-options] configuration hierarchy:
[edit routing-options]
user@host# set validation group <group-name> session <RPKI Server IP> port
<RPKI Server Port> local-address <Local IP>
Where:


<group-name> is a descriptive name chosen for the RPKI Server


<RPKI Server IP> is the IP address used on the RPKI Validator for the RPKI-RTR
protocol


<RPKI Server Port> is the port configured on RPKI Validator for the RPKI-RTR
protocol


<Local IP> is a Local Interface address that the Router should use as the source for
RPKI-RTR sessions
**Note ** - If multiple Logical Systems are configured, RPKI Validation will need to be
configured separately for all LSYS being used for Public BGP Peering.



Next create a Routing Policy to accept or reject routes based on the RPKI Validation
Database, using the following commands for each term from the [edit policy-options]
heirachy:
[edit policy-options]
user@host# set policy-statement <policy-name> term <term-name> from protocol
bgp
user@host# set policy-statement <policy-name> term <term-name> from
validation-database <RPKI Database Result>
user@host# set policy-statement <policy-name> term <term-name> then
validation-state <RPKI State>
user@host# set policy-statement <policy-name> term <term-name> then <action>
Where:


<policy-name> is a descriptive name for the Routing Policy


<term-name> is a descriptive name for the Term


<RPKI Database Result> is the result returned by the RPKI Validator


<RPKI State> is the RPKI State to be recorded locally for the route (normally the
same as the RPKI Validator result)


<action> is a Routing Policy action such as to accept or reject the route
These steps can be repeated until all of your required terms and actions are configured.
Here we create the rpki-validation Routing Policy given in the Audit Procedure example:
[edit policy-options]
user@host# set policy-statement rpki-validation term valid from protocol bgp
user@host# set policy-statement rpki-validation term valid from validation-
database valid
user@host# set policy-statement rpki-validation term valid then validation-
state valid
user@host# set policy-statement rpki-validation term valid then accept
user@host# set policy-statement rpki-validation term invalid from protocol
bgp
user@host# set policy-statement rpki-validation term invalid from validation-
database invalid
user@host# set policy-statement rpki-validation term invalid then validation-
state invalid
user@host# set policy-statement rpki-validation term invalid then reject
user@host# set policy-statement rpki-validation term unknown from protocol
bgp
user@host# set policy-statement rpki-validation term unknown then validation-
state unknown
user@host# set policy-statement rpki-validation term unknown then accept



The final term matches on all BGP Routes which do not return either valid or invalid
from the RPKI Server, so does not require the additional match condition on the
validation-database result.
The RPKI Routing Policy should now be applied to all BGP Neighbours or Groups used for
Public BGP peering using the following commands from the [edit protocols bgp]
configuration heirachy:
[edit protocols bgp]
user@host# set group <group-name> import <policy-name>
OR
[edit protocols bgp]
user@host# set neighbor <Neighbor IP> import <policy-name>
Where:

is the name of the BGP Group

is the Routing Policy configured in the previous step

is the IP Address of the individual neighbor to which policy will be applied
Note - Other BGP Import policies may already be applied, it is important to ensure all policy is
applied correctly and in the correct order to prevent disruption to the network.

.