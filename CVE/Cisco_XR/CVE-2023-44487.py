from comfy.compliance import medium


@medium(
    name='rule_cve_2023_44487',
    platform=['cisco_xr'],
    commands=dict(version='show version | include Software', formal='show run formal')
)
def rule_cve_2023_44487(configuration, commands, device):
    import re
    pattern = r"Version\s([0-9.]+)"
    match = re.search(pattern, str(commands.version))
    s_version = match.group(1) if match else '0.0.0'
    version = tuple(map(int, s_version.split('.')))
    assert version > (7, 11, 2)
